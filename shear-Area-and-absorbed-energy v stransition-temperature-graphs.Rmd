---
title: "HT Function"
author: "RSI PIpeline Slutions"
date: "6/11/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```
## R Markdown
```{r data}
library(readxl)
library(tidyverse)
library(zoo)


# Read data in
tim_cvn <-
  read_excel(
    "timp_met_charpy_clean_rev02.xlsx",
    sheet = "Charpy"
  ) %>% 
  janitor::clean_names() %>%
   rename(
    location = specimen_location,
    temp_f = test_temperature_f,
    charpy_thickness_mm = specimen_thickness_mm,
    cvn_ss_ft_lbs = measured_energy_absorbed_ft_lbs,
    sa_ss = shear_area_percent
  ) %>%
  mutate(across(temp_f:sa_ss, as.numeric), 
         sa_ss = as.numeric(str_remove(string = sa_ss,pattern = c("<", ">")))) %>%
  filter(str_detect(location, "Base Metal"),   #removing weld tests
        str_detect(single_or_multiple_temperature_test, "Multiple"), #remove single temp tests
        str_detect(full_transition_curve, "Yes"),
         sa_ss<=100, bar_orientation== "Transverse (T-L)") %>% #removing shear areas greater than 100
  select(id, bar_orientation, charpy_thickness_mm, temp_f, cvn_ss_ft_lbs, sa_ss)
 
#list of id that max is less than 90%
idlist <- tim_cvn %>% 
  group_by(id) %>% 
  summarise(mx_sa=max(sa_ss)) %>% 
  filter(mx_sa<90)

temp_id_list <- tim_cvn %>% 
  group_by(id, temp_f) %>% 
  summarise(unique(temp_f)) %>% 
  mutate(count = n()) %>% 
  filter(count<4)

`%notin%` <- Negate(`%in%`) # not in special function

tim_cvn <- tim_cvn %>% 
  filter(id %notin% idlist$id,
         id %notin% temp_id_list$id)

ids <- unique(tim_cvn$id) #create vector of ids



# hyperbolic tangent function
func <- function(temp_f, A, B, C, D) {
  A + B * tanh((temp_f - D) / C)
}

## played around with A,B,C,D so that the function was
## close for first few data points
## then used this as starting points for nls
# USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
# USE
# LSE = min(data$cvn_ss_ft_lbs)
# LSE
# Ai <- (USE + LSE)/2
# Bi <- (USE - LSE)/2
# Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
#   mutate(bc = Bi/slope)
# Ci = Ci$bc
# Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
#   select(mean_t)
# Di = Di$mean_t


make_plot <- function(id) {
  tim_cvn %>%
    filter(.data$id == .env$id) %>%
    ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
    geom_point() +
    stat_function(fun = func,
                  args = list(Ai, Bi, Ci, Di)) +
    theme_minimal() +
    annotate(
      "text",
      x = min(data$temp_f)+5,
      y = max(data$cvn_ss_ft_lbs)-5,
      label = paste("A =", Ai,
                    ",B =", Bi,
                    ",C =", Ci,
                    ",D =", Di),
      hjust = 0
    ) +
    labs(title = paste("ID =", ids[idx]))
}


make_plot2 <- function(id) {
  tim_cvn %>%
    filter(.data$id == .env$id) %>%
    ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
    geom_point() +
    stat_function(fun = func,
                  args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
    theme_minimal() +
    annotate(
      "text",
      x = min(data$temp_f)+5,
      y = max(data$cvn_ss_ft_lbs)-5,
      label = paste("A =", 
                    round(coefs[1], 1),
                    ",B =", 
                    round(coefs[2], 1),
                    ",C =", 
                    round (coefs[3],1),
                    ",D =", 
                    round (coefs[4],1)
                    ),
      hjust = 0
    ) +
    labs(title = paste("ID =", ids[idx]),x="Temperature (Â°F)", y = "absorbed energy (ft-lbs")
  
}


  make_plot3 <- function(id) {
  tim_cvn %>%
    filter(.data$id == .env$id, .data$bar_orientation== "Longitudinal (L-T)") %>%
    ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
    geom_point() +
    stat_function(fun = func,
                  args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
    theme_minimal() +
    annotate(
      "text",
      x = min(data$temp_f)+5,
      y = max(data$cvn_ss_ft_lbs)-5,
      label = paste("A =", coefs[1],
                    ",B =", coefs[2],
                    ",C =", coefs[3],
                    ",D =", coefs[4]),
      hjust = 0
    ) +
    labs(title = paste("ID =", ids[idx]),x="Temperature (F)", y = "absorbed energy")

}
```


```{r}
plots_shear_area <- function(id) {
  tim_cvn %>%
    filter(.data$id == .env$id) %>%
    ggplot(aes(temp_f, sa_ss)) +
    geom_point() +
    stat_function(fun = func,
                  args = list(Ai, Bi, Ci, Di)) +
    theme_minimal() +
    annotate(
      "text",
      x = min(data$temp_f)+5,
      y = max(data$sa_ss)-5,
      label = paste("A =", Ai,
                    ",B =", Bi,
                    ",C =", Ci,
                    ",D =", Di),
      hjust = 0
    ) +
    labs(title = paste("ID =", ids[idx]))
}
```


## plot 1 - Shear Area
```{r plot_1_sa}
idx <- 1 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))



```


## plot 1 - Absorbed Energy
```{r plot_1}
idx <- 1 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))




count <- data %>% count(bar_orientation)


USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))



make_plot2(ids[idx])
```


## plot 2- Shear Area

```{r plot_2sa}
idx <- 2 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))
```


## plot 2 - Absorbed Energy

```{r plot_2}
idx <- 2 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))
```


## plot 3- Shear Area


```{r plot_3sa}
idx <- 3 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))
```


## plot 3 - Absorbed Energy 

```{r plot_3}
idx <- 3 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))
```


## plot 4- Shear Area
(Error in fit)
```{r plot_4sa}
idx <- 4 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% 
  filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])

# 
# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# cofs <- coef(fit)
# data %>% 
# rename(t = temp) %>%
  # ggplot(aes(temp_f, sa_ss)) +
  # geom_point() +
  # stat_function(fun = func,
  #               args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  # theme_minimal() +
  # annotate(
  #   "text",
  #   x = min(data$temp_f)+5,
  #   y = max(data$sa_ss)-5 ,
  #   label = paste("A =", round(coefs[1],1),
  #                 ",B =", round(coefs[2],1),
  #                 ",C =", round(coefs[3],1),
  #                 ",D =", round(coefs[4],1)),
  #   hjust = 0
  # ) +
  # labs(title = paste("ID =", ids[idx]))



```


## plot 4 - Absorbed Energy

```{r plot_4}
idx <- 4 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 5- Shear Area
 (Error in fit)

```{r plot_5sa}
idx <- 5 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))



```


## plot 5 - absorbed energy
 (Error in fit)

```{r plot_5}
idx <- 5 

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 6- Shear Area


```{r plot_6sa}
idx <- 6 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))



```


## plot 6 - absorbed energy


```{r plot_6}
idx <- 6

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 7- Shear Area


```{r plot_7sa}
idx <- 7 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))



```


## plot 7 - absorbed energy

```{r plot_7}
idx <- 7

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 8- Shear Area
 (Error in fit)

```{r plot_8sa}
idx <- 8 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))



```


## plot 8 - absorbed energy

```{r plot_8}
idx <- 8

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 9- Shear Area


```{r plot_9sa}
idx <- 9 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))



```


## plot 9 - absorbed energy

```{r plot_9}
idx <- 9

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 10- Shear Area


```{r plot_10sa}
idx <- 10 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))



```


## plot 10 - absorbed energy

```{r plot_10}
idx <- 10

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 11- Shear Area
 (Error in fit)

```{r plot_11sa}
idx <- 11 #start index at 11

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))



```



## plot 11 - absorbed energy
 ((Error in fit))
```{r plot_11}
idx <- 11

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 12- Shear Area


```{r plot_12sa}
idx <- 12 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 12 - absorbed energy
 (Error in fit)
```{r plot_12}
idx <- 12

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,6,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,6,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f))) %>% 
  filter( temp_f!=32)

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])

# Ai <- -90
# Bi <- 117
# Ci <- 68
# Di <- -100

# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     control = list( maxiter=1000) ,
#     trace = F
#       
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 13- Shear Area


```{r plot_13sa}
idx <- 13 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 13 - absorbed energy

```{r plot_13}
idx <- 13

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 14- Shear Area


```{r plot_14sa}
idx <- 14 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 14 - absorbed energy

```{r plot_14}
idx <- 14

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 15- Shear Area


```{r plot_15sa}
idx <- 15 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 15 - absorbed energy

```{r plot_15}
idx <- 15

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 16- Shear Area


```{r plot_16sa}
idx <- 16 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 16 - absorbed energy

```{r plot_16}
idx <- 16

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 17- Shear Area
 (Error in fit)

```{r plot_17sa}
idx <- 17 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,6,fill = NA), 
         mean_cvn = rollmean(sa_ss,6,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))
# data <- data %>% group_by(temp_f) %>% slice_sample(n=2) %>% 
#   ungroup() %>% filter(temp_f!= 40)

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])

# Ci = 10
# Di = 70

# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = T,control = list(minFactor=1/1e4)
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 17 - absorbed energy
 (Error in fit)
```{r plot_17}
idx <- 17

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f))) 

data <- data %>% group_by(temp_f) %>% slice_sample(n = 2) %>% ungroup()

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# 
# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 18- Shear Area


```{r plot_18sa}
idx <- 18 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 18 - absorbed energy

```{r plot_18}
idx <- 18

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 19- Shear Area
 (Error in fit)

```{r plot_19sa}
idx <- 19 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 19 - absorbed energy
 (Error in fit)
```{r plot_19}
idx <- 19

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 20 - Shear Area


```{r plot_20sa}
idx <- 20 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 20 - absorbed energy

```{r plot_20}
idx <- 20

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 21 - Shear Area


```{r plot_21sa}
idx <- 21 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 21 - absorbed energy
(Error in fit)
```{r plot_21}
idx <- 21

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 22 - Shear Area
(Error in fit)

```{r plot_22sa}
idx <- 22 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 22 - absorbed energy
(Error in fit)
```{r plot_22}
idx <- 22

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```



## plot 23 - Shear Area
(Error in fit)

```{r plot_23sa}
idx <- 23 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 23 -absorbed energy
(Error in fit)
```{r plot_23}
idx <- 23

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 24 - Shear Area


```{r plot_24sa}
idx <- 24 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 24 -absorbed energy

```{r plot_24}
idx <- 24

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 25 - Shear Area
(Error in fit)

```{r plot_25sa}
idx <- 25 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 25 -absorbed energy
(Error in fit)
```{r plot_25}
idx <- 25

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 26 - Shear Area
(Error in fit)

```{r plot_26sa}
idx <- 26 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 26 -absorbed energy
(Error in fit)
```{r plot_26}
idx <- 26

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 27 - Shear Area
(Error in fit)

```{r plot_27sa}
idx <- 27 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 27 -absorbed energy
(Error in fit)
```{r plot_27}
idx <- 27

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
# 
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))
```


## plot 28 - Shear Area
(Error in fit)

```{r plot_28sa}
idx <- 28 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```



## plot 28 -absorbed energy

```{r plot_28}
idx <- 28

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 29 - Shear Area
(Error in fit)

```{r plot_29sa}
idx <- 29 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 29 -absorbed energy
(Error in fit)
```{r plot_29}
idx <- 29

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 30 - Shear Area
 

```{r plot_30sa}
idx <- 30 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 30 -absorbed energy

```{r plot_30}
idx <- 30

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 31 - Shear Area


```{r plot_31sa}
idx <- 31 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 31 -absorbed energy

```{r plot_31}
idx <- 31

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 32 - Shear Area
(Error in fit)

```{r plot_32sa}
idx <- 32 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 32 -absorbed energy
(Error in fit)
```{r plot_32}
idx <- 32

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 33 - Shear Area
(Error in fit)

```{r plot_33sa}
idx <- 33 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 33 -absorbed energy

```{r plot_33}
idx <- 33

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 34 - Shear Area
(Error in fit)

```{r plot_34sa}
idx <- 34 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 34 -absorbed energy
(Error in fit)
```{r plot_34}
idx <- 34

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


# plot 35 - Shear Area
(Error in fit)

```{r plot_35sa}
idx <- 35 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 35 -absorbed energy
(Error in fit)
```{r plot_35}
idx <- 35

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


# plot 36 - Shear Area
 

```{r plot_36}
idx <- 36 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 36 -absorbed energy

```{r plot_36sa}
idx <- 36

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 37 - Shear Area


```{r plot_37}
idx <- 37 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 37 -absorbed energy

```{r plot_37sa}
idx <- 37

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 38 - Shear Area
 

```{r plot_38sa}
idx <- 38 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 38 -absorbed energy

```{r plot_38}
idx <- 38

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 39 - Shear Area


```{r plot_39sa}
idx <- 39 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 39 -absorbed energy

```{r plot_39}
idx <- 39

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 40 - Shear Area


```{r plot_40sa}
idx <- 40 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 40 -absorbed energy

```{r plot_40}
idx <- 40

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 41 - Shear Area


```{r plot_41sa}
idx <- 41 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 41 -absorbed energy

```{r plot_41}
idx <- 41

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 42 - Shear Area


```{r plot_42sa}
idx <- 42 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 42 -absorbed energy

```{r plot_42}
idx <- 42

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 43 - Shear Area


```{r plot_43sa}
idx <- 43 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 43 -absorbed energy

```{r plot_43}
idx <- 43

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 44 - Shear Area


```{r plot_44sa}
idx <- 44 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 44-absorbed energy

```{r plot_44}
idx <- 44

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 45 - Shear Area


```{r plot_45sa}
idx <- 45 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 45 -absorbed energy

```{r plot_45}
idx <- 45

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 46 - Shear Area


```{r plot_46sa}
idx <- 46 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 46 -absorbed energy

```{r plot_46}
idx <- 46

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 47 - Shear Area


```{r plot_47sa}
idx <- 47 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 47 -absorbed energy

```{r plot_47}
idx <- 47

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 48 - Shear Area


```{r plot_48sa}
idx <- 48 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 48 -absorbed energy

```{r plot_48}
idx <- 48

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 49 - Shear Area


```{r plot_49sa}
idx <- 49 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 49 -absorbed energy

```{r plot_49}
idx <- 49

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 50 - Shear Area


```{r plot_50sa}
idx <- 50 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 50 -absorbed energy

```{r plot_50}
idx <- 50

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 51 - Shear Area
(Error in fit)

```{r plot_51sa}
idx <- 51 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 51 -absorbed energy

```{r plot_51}
idx <- 51

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 52 - Shear Area
(Error in fit)

```{r plot_52sa}
idx <- 52 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 52 -absorbed energy

```{r plot_52}
idx <- 52

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 53 - Shear Area


```{r plot_53sa}
idx <- 53 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 53 -absorbed energy

```{r plot_53}
idx <- 53

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 54 - Shear Area
(Error in fit)

```{r plot_54sa}
idx <- 54 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 54 -absorbed energy

```{r plot_54}
idx <- 54

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 55 - Shear Area
(Error in fit)

```{r plot_55sa}
idx <- 55 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 55 -absorbed energy

```{r plot_55}
idx <- 55

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 56 - Shear Area


```{r plot_56sa}
idx <- 56 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 56 -absorbed energy

```{r plot_56}
idx <- 56

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 57 - Shear Area


```{r plot_57sa}
idx <- 57 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 57 -absorbed energy

```{r plot_57}
idx <- 57

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 58 - Shear Area
(Error in fit)

```{r plot_58sa}
idx <- 58 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 58 -absorbed energy
(Error in fit)
```{r plot_58}
idx <- 58

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$cvn_ss_ft_lbs)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


# plot 59 - Shear Area
(Error in fit)

```{r plot_59sa}
idx <- 59 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 59 -absorbed energy

```{r plot_59}
idx <- 59

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 60 - Shear Area


```{r plot_60sa}
idx <- 60 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


## plot 60 -absorbed energy

```{r plot_60}
idx <- 60

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


# plot 61 - Shear Area
(Error in fit)

```{r plot_61sa}
idx <- 61 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


# fit <-
#   nls(
#     sa_ss ~ func(temp_f, A, B, C, D),
#     data = data ,
#     start = list(
#       A = Ai,
#       B = Bi,
#       C = Ci,
#       D = Di
#     ),
#     trace = F
#   )
# 
# coefs <- coef(fit)
# data %>% 
#   # rename(t = temp) %>%
#   ggplot(aes(temp_f, sa_ss)) +
#   geom_point() +
#   stat_function(fun = func,
#                 args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
#   theme_minimal() +
#   annotate(
#     "text",
#     x = min(data$temp_f)+5,
#     y = max(data$sa_ss)-5 ,
#     label = paste("A =", round(coefs[1],1),
#                   ",B =", round(coefs[2],1),
#                   ",C =", round(coefs[3],1),
#                   ",D =", round(coefs[4],1)),
#     hjust = 0
#   ) +
#   labs(title = paste("ID =", ids[idx]))

```


## plot 61 -absorbed energy

```{r plot_61}
idx <- 61

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```

## plot 62
Say something about plot 62
```{r plot_62}
idx <- 62

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 62 - Shear Area
Say something about plot 62 (Error)

```{r plot_62sa}
idx <- 62 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
## plot 63
Say something about plot 63
```{r plot_63}
idx <- 63

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 63 - Shear Area
Say something about plot 63

```{r plot_63sa}
idx <- 63 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
## plot 64
Say something about plot 64
```{r plot_64}
idx <- 64

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 64 - Shear Area
Say something about plot 64

```{r plot_64sa}
idx <- 64 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```

## plot 65
Say something about plot 65 (Error)
```{r plot_65}
idx <- 65

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 65 - Shear Area
Say something about plot 65 (Error)

```{r plot_65sa}
idx <- 65 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```

## plot 66
Say something about plot 66
```{r plot_66}
idx <- 66

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 66 - Shear Area
Say something about plot 66

```{r plot_66sa}
idx <- 66 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
## plot 67
Say something about plot 67
```{r plot_67}
idx <- 67

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 67 - Shear Area
Say something about plot 67

```{r plot_67sa}
idx <- 67 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
## plot 68
Say something about plot 68
```{r plot_68}
idx <- 68

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(cvn_ss_ft_lbs,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$cvn_ss_ft_lbs) #UPPER SHELF ENERGY
USE
LSE = min(data$cvn_ss_ft_lbs)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    cvn_ss_ft_lbs ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, cvn_ss_ft_lbs)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$cvn_ss_ft_lbs)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```
# plot 68 - Shear Area
Say something about plot 68

```{r plot_68sa}
idx <- 68 #start index at 1

data <- tim_cvn %>% 
  filter(id==ids[idx]) %>% 
  mutate(mean_t = rollmean(temp_f,4,fill = NA), 
         mean_cvn = rollmean(sa_ss,4,fill = NA),
         slope = (mean_cvn - first(cvn_ss_ft_lbs)) / (mean_t - first(temp_f)))

USE = max(data$sa_ss) #UPPER SHELF ENERGY
USE
LSE = min(data$sa_ss)
LSE
Ai <- (USE + LSE)/2
Bi <- (USE - LSE)/2
Ci <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  mutate(bc = Bi/slope)
Ci = Ci$bc
Di <- data %>% filter(slope == max(slope, na.rm = TRUE)) %>% 
  select(mean_t)
Di = Di$mean_t

#make_plot(ids[idx])


fit <-
  nls(
    sa_ss ~ func(temp_f, A, B, C, D),
    data = data ,
    start = list(
      A = Ai,
      B = Bi,
      C = Ci,
      D = Di
    ),
    trace = F
  )

coefs <- coef(fit)
data %>% 
  # rename(t = temp) %>%
  ggplot(aes(temp_f, sa_ss)) +
  geom_point() +
  stat_function(fun = func,
                args = list(coefs[1], coefs[2], coefs[3], coefs[4])) +
  theme_minimal() +
  annotate(
    "text",
    x = min(data$temp_f)+5,
    y = max(data$sa_ss)-5 ,
    label = paste("A =", round(coefs[1],1),
                  ",B =", round(coefs[2],1),
                  ",C =", round(coefs[3],1),
                  ",D =", round(coefs[4],1)),
    hjust = 0
  ) +
  labs(title = paste("ID =", ids[idx]))

```


